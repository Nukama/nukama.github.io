---
layout: post
title: The Blue Pill Hype
date: '2006-07-01T12:27:00.001+02:00'
author: Joanna Rutkowska
tags: 
modified_time: '2009-03-19T22:23:20.664+01:00'
blogger_id: tag:blogger.com,1999:blog-24586388.post-115175064263272833
blogger_orig_url: http://theinvisiblethings.blogspot.com/2006/07/blue-pill-hype.html
---

All the hype started from this <a href="http://www.eweek.com/article2/0,1895,1983037,00.asp">article in eWeek</a> by Ryan Naraine... The article is mostly accurate, despite one detail - the tile, which is a little misleading...  It suggests that I already implemented "a prototype of Blue Pill which creates 100% undetectable malware", which is not true. Should this be true, I would not call my implementation "a prototype", which suggests some early stage of product.<br /><br />That being said, I sincerely believe that Blue Pill technology will (very soon) allow for creating <b>100% undetectable malware, which is not based on obscurity of the concept</b>. And I already stressed this in the description of my talk <a href="http://syscan.org/program.html">here</a> and <a href="http://blackhat.com/html/bh-usa-06/bh-usa-06-speakers.html#Rutkowska">here</a>. The working prototype I have (and which I will be demonstrating at SyScan and Black Hat) implements the most important step towards creating such malware, namely it allows to move the underlying operating system, <b>on the fly</b>, into a secure virtual machine.<br /><br />The phrase "on the fly" is the most important thing about Blue Pill - it makes it possible to install a blue pill based malware <b>without restarting the system and without any BIOS or boot sector modifications</b>. I wish all those people who were posting about how easy it would be to detect Blue Pill by booting a system from a clean CD, spent more time on reading my original blog article, instead creating useless posts... (just a little wish).<br /><br />The Blue Pill prototype I currently have is not yet complete, but this is not that important, because having successfully moved the OS into a virtual machine, implementing all the other features is just a matter of following the Pacifica specification. And I will repeat my statement again: I believe the malware based on a fully implemented Blue Pill will be 100% undetectable, provided that Pacifica is not "buggy". 100% undetectable <i>in practice</i> - I should add - as I'm aware of some theoretical brute force attacks, which I however do not consider as being practical and that they could be used in the future anywhere outside the lab. It should be undetectable, even if the malware code was made available to the opponent (e.g. AV company).<br /><br />There are number of ways of how Blue Pill could be exploited to create the actual malware (Blue Pill itself is just a "hijacking technology", not a malware) and I will be showing a simple example of how it could be used to create a network backdoor on Vista x64.<br /><br />What happens when you install Blue Pill on a machine which is already Blue Pilled? Should future OS come with own, preinstalled hypervisor to prevent Blue Pill installation? What about timing analysis? All those questions will be answered during my  presentation - please do not send or post the same questions again and again...<br /><br />That all being said, I don't think the title in the eWeek article was too much exaggerated, but I just wanted to clarify the things. After all, it was very positive, IMO, that the article attracted lots of attention, because I believe that hardware virtualization technology could become one of the biggest threat in the coming years (i.e. when more people will use processors with hardware virtualization support) and if we do not do anything about it. Can we do anything? I believe we can, but first we need to understand the threat.<br /><br />One more thing should be commented. Some people suggested that my work is sponsored by Intel as I focused on AMD virtualization technolgy only. They should know then, that my work was sponsored exclusively by <a href="http://www.coseinc.com/">COSEINC Research</a> and not by Intel. I implemented Blue Pill on AMD64 just because my previous research (also done for COSEINC) were focusing on Vista x64 and the natural choice of the processor for this was AMD64. And, although I wish I had more time to also try implementing Blue Pill on Intel VT, unfortunately I don't :( Accusing myslef of doing this on one processor only, instead on both AMD and Intel, is like saying that all vulnerability researches who find holes inside open source programs are paid by Microsoft ;) This is just ridicules!